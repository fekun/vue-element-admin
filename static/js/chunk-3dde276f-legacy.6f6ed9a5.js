(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3dde276f"],{6724:function(e,t,n){"use strict";var a=n("5176"),l=n.n(a),i=(n("8d41"),"@@wavesContext");function s(e,t){function n(n){var a=l()({},t.value),i=l()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),s=i.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var o=s.getBoundingClientRect(),r=s.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":(r=document.createElement("span"),r.className="waves-ripple",r.style.height=r.style.width=Math.max(o.width,o.height)+"px",s.appendChild(r)),i.type){case"center":r.style.top=o.height/2-r.offsetHeight/2+"px",r.style.left=o.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(n.pageY-o.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(n.pageX-o.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=i.color,r.className="waves-ripple z-active",!1}}return e[i]?e[i].removeHandle=n:e[i]={removeHandle:n},n}var o={bind:function(e,t){e.addEventListener("click",s(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[i].removeHandle,!1),e.addEventListener("click",s(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[i].removeHandle,!1),e[i]=null,delete e[i]}},r=function(e){e.directive("waves",o)};window.Vue&&(window.waves=o,Vue.use(r)),o.install=r;t["a"]=o},"8d41":function(e,t,n){},c0a4:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("table.title")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}}),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{placeholder:e.$t("table.importance"),clearable:""},model:{value:e.listQuery.importance,callback:function(t){e.$set(e.listQuery,"importance",t)},expression:"listQuery.importance"}},e._l(e.importanceOptions,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:e.$t("table.type"),clearable:""},model:{value:e.listQuery.type,callback:function(t){e.$set(e.listQuery,"type",t)},expression:"listQuery.type"}},e._l(e.calendarTypeOptions,function(e){return n("el-option",{key:e.key,attrs:{label:e.display_name+"("+e.key+")",value:e.key}})}),1),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},on:{change:e.handleFilter},model:{value:e.listQuery.sort,callback:function(t){e.$set(e.listQuery,"sort",t)},expression:"listQuery.sort"}},e._l(e.sortOptions,function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})}),1),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n      "+e._s(e.$t("table.search"))+"\n    ")]),e._v(" "),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("\n      "+e._s(e.$t("table.add"))+"\n    ")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("\n      "+e._s(e.$t("table.export"))+"\n    ")]),e._v(" "),n("el-checkbox",{staticClass:"filter-item",staticStyle:{"margin-left":"15px"},on:{change:function(t){e.tableKey=e.tableKey+1}},model:{value:e.showReviewer,callback:function(t){e.showReviewer=t},expression:"showReviewer"}},[e._v("\n      "+e._s(e.$t("table.reviewer"))+"\n    ")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"sort-change":e.sortChange}},[n("el-table-column",{attrs:{label:e.$t("table.id"),prop:"id",sortable:"custom",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.date"),width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e._f("parseTime")(t.row.timestamp,"{y}-{m}-{d} {h}:{i}")))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.title"),"min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",{staticClass:"link-type",on:{click:function(t){return e.handleUpdate(a)}}},[e._v(e._s(a.title))]),e._v(" "),n("el-tag",[e._v(e._s(e._f("typeFilter")(a.type)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.author"),width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.author))])]}}])}),e._v(" "),e.showReviewer?n("el-table-column",{attrs:{label:e.$t("table.reviewer"),width:"110px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.reviewer))])]}}],null,!1,295318502)}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.importance"),width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(+t.row.importance,function(e){return n("svg-icon",{key:e,staticClass:"meta-item__icon",attrs:{"icon-class":"star"}})})}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.readings"),align:"center",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.pageviews?n("span",{staticClass:"link-type",on:{click:function(t){return e.handleFetchPv(a.pageviews)}}},[e._v(e._s(a.pageviews))]):n("span",[e._v("0")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.status"),"class-name":"status-col",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-tag",{attrs:{type:e._f("statusFilter")(a.status)}},[e._v("\n          "+e._s(a.status)+"\n        ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("table.actions"),align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(a)}}},[e._v("\n          "+e._s(e.$t("table.edit"))+"\n        ")]),e._v(" "),"published"!=a.status?n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.handleModifyStatus(a,"published")}}},[e._v("\n          "+e._s(e.$t("table.publish"))+"\n        ")]):e._e(),e._v(" "),"draft"!=a.status?n("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleModifyStatus(a,"draft")}}},[e._v("\n          "+e._s(e.$t("table.draft"))+"\n        ")]):e._e(),e._v(" "),"deleted"!=a.status?n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleModifyStatus(a,"deleted")}}},[e._v("\n          "+e._s(e.$t("table.delete"))+"\n        ")]):e._e()]}}])})],1),e._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),n("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:e.$t("table.type"),prop:"type"}},[n("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.type,callback:function(t){e.$set(e.temp,"type",t)},expression:"temp.type"}},e._l(e.calendarTypeOptions,function(e){return n("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("table.date"),prop:"timestamp"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"Please pick a date"},model:{value:e.temp.timestamp,callback:function(t){e.$set(e.temp,"timestamp",t)},expression:"temp.timestamp"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("table.title"),prop:"title"}},[n("el-input",{model:{value:e.temp.title,callback:function(t){e.$set(e.temp,"title",t)},expression:"temp.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("table.status")}},[n("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.status,callback:function(t){e.$set(e.temp,"status",t)},expression:"temp.status"}},e._l(e.statusOptions,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("table.importance")}},[n("el-rate",{staticStyle:{"margin-top":"8px"},attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],max:3},model:{value:e.temp.importance,callback:function(t){e.$set(e.temp,"importance",t)},expression:"temp.importance"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("table.remark")}},[n("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"Please input"},model:{value:e.temp.remark,callback:function(t){e.$set(e.temp,"remark",t)},expression:"temp.remark"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n        "+e._s(e.$t("table.cancel"))+"\n      ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("\n        "+e._s(e.$t("table.confirm"))+"\n      ")])],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogPvVisible,title:"Reading statistics"},on:{"update:visible":function(t){e.dialogPvVisible=t}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pvData,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{prop:"key",label:"Channel"}}),e._v(" "),n("el-table-column",{attrs:{prop:"pv",label:"Pv"}})],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogPvVisible=!1}}},[e._v(e._s(e.$t("table.confirm")))])],1)],1),e._v(" "),n("ClipBoard",{attrs:{code:e.code,"related-link":e.relatedLink}})],1)},l=[],i=n("5d73"),s=n.n(i),o=n("5176"),r=n.n(o),c=n("e814"),p=n.n(c),d=n("2423"),m=n("6724"),u=n("ed08"),h=n("333d"),f=n("1fb2"),b=[{key:"CN",display_name:"China"},{key:"US",display_name:"USA"},{key:"JP",display_name:"Japan"},{key:"EU",display_name:"Eurozone"}],v=b.reduce(function(e,t){return e[t.key]=t.display_name,e},{}),y={name:"ComplexTable",components:{Pagination:h["a"],ClipBoard:f["a"]},directives:{waves:m["a"]},filters:{statusFilter:function(e){var t={published:"success",draft:"info",deleted:"danger"};return t[e]},typeFilter:function(e){return v[e]}},data:function(){return{tableKey:0,list:null,total:0,listLoading:!0,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"},importanceOptions:[1,2,3],calendarTypeOptions:b,sortOptions:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:!1,temp:{id:void 0,importance:1,remark:"",timestamp:new Date,title:"",type:"",status:"published"},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},dialogPvVisible:!1,pvData:[],rules:{type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],title:[{required:!0,message:"title is required",trigger:"blur"}]},downloadLoading:!1,relatedLink:[{title:"@/api/article",link:"https://github.com/PanJiaChen/vue-element-admin/blob/master/src/api/article.js"},{title:"@/directive/waves",link:"https://github.com/PanJiaChen/vue-element-admin/tree/master/src/directive/waves"},{title:"@/utils",link:"https://github.com/PanJiaChen/vue-element-admin/tree/master/src/utils"},{title:"@/components/Pagination",link:"https://github.com/PanJiaChen/vue-element-admin/tree/master/src/components/Pagination"}],code:'\n<template>\n  <div class="app-container">\n    <div class="filter-container">\n      <el-input\n        v-model="listQuery.title"\n        :placeholder="$t(\'table.title\')"\n        style="width: 200px;"\n        class="filter-item"\n        @keyup.enter.native="handleFilter"\n      />\n      <el-select\n        v-model="listQuery.importance"\n        :placeholder="$t(\'table.importance\')"\n        clearable\n        style="width: 90px"\n        class="filter-item"\n      >\n        <el-option\n          v-for="item in importanceOptions"\n          :key="item"\n          :label="item"\n          :value="item"\n        />\n      </el-select>\n      <el-select\n        v-model="listQuery.type"\n        :placeholder="$t(\'table.type\')"\n        clearable\n        class="filter-item"\n        style="width: 130px"\n      >\n        <el-option\n          v-for="item in calendarTypeOptions"\n          :key="item.key"\n          :label="item.display_name+\'(\'+item.key+\')\'"\n          :value="item.key"\n        />\n      </el-select>\n      <el-select\n        v-model="listQuery.sort"\n        style="width: 140px"\n        class="filter-item"\n        @change="handleFilter"\n      >\n        <el-option\n          v-for="item in sortOptions"\n          :key="item.key"\n          :label="item.label"\n          :value="item.key"\n        />\n      </el-select>\n      <el-button\n        v-waves\n        class="filter-item"\n        type="primary"\n        icon="el-icon-search"\n        @click="handleFilter"\n      >\n        {{ $t(\'table.search\') }}\n      </el-button>\n      <el-button\n        class="filter-item"\n        style="margin-left: 10px;"\n        type="primary"\n        icon="el-icon-edit"\n        @click="handleCreate"\n      >\n        {{ $t(\'table.add\') }}\n      </el-button>\n      <el-button\n        v-waves\n        :loading="downloadLoading"\n        class="filter-item"\n        type="primary"\n        icon="el-icon-download"\n        @click="handleDownload"\n      >\n        {{ $t(\'table.export\') }}\n      </el-button>\n      <el-checkbox\n        v-model="showReviewer"\n        class="filter-item"\n        style="margin-left:15px;"\n        @change="tableKey=tableKey+1"\n      >\n        {{ $t(\'table.reviewer\') }}\n      </el-checkbox>\n    </div>\n\n    <el-table\n      :key="tableKey"\n      v-loading="listLoading"\n      :data="list"\n      border\n      fit\n      highlight-current-row\n      style="width: 100%;"\n      @sort-change="sortChange"\n    >\n      <el-table-column\n        :label="$t(\'table.id\')"\n        prop="id"\n        sortable="custom"\n        align="center"\n        width="80"\n      >\n        <template slot-scope="scope">\n          <span>{{ scope.row.id }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.date\')"\n        width="150px"\n        align="center"\n      >\n        <template slot-scope="scope">\n          <span>{{ scope.row.timestamp | parseTime(\'{y}-{m}-{d} {h}:{i}\') }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.title\')"\n        min-width="150px"\n      >\n        <template slot-scope="{row}">\n          <span\n            class="link-type"\n            @click="handleUpdate(row)"\n          >{{ row.title }}</span>\n          <el-tag>{{ row.type | typeFilter }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.author\')"\n        width="110px"\n        align="center"\n      >\n        <template slot-scope="scope">\n          <span>{{ scope.row.author }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        v-if="showReviewer"\n        :label="$t(\'table.reviewer\')"\n        width="110px"\n        align="center"\n      >\n        <template slot-scope="scope">\n          <span style="color:red;">{{ scope.row.reviewer }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.importance\')"\n        width="80px"\n      >\n        <template slot-scope="scope">\n          <svg-icon\n            v-for="n in +scope.row.importance"\n            :key="n"\n            icon-class="star"\n            class="meta-item__icon"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.readings\')"\n        align="center"\n        width="95"\n      >\n        <template slot-scope="{row}">\n          <span\n            v-if="row.pageviews"\n            class="link-type"\n            @click="handleFetchPv(row.pageviews)"\n          >{{ row.pageviews }}</span>\n          <span v-else>0</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.status\')"\n        class-name="status-col"\n        width="100"\n      >\n        <template slot-scope="{row}">\n          <el-tag :type="row.status | statusFilter">\n            {{ row.status }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column\n        :label="$t(\'table.actions\')"\n        align="center"\n        width="230"\n        class-name="small-padding fixed-width"\n      >\n        <template slot-scope="{row}">\n          <el-button\n            type="primary"\n            size="mini"\n            @click="handleUpdate(row)"\n          >\n            {{ $t(\'table.edit\') }}\n          </el-button>\n          <el-button\n            v-if="row.status!=\'published\'"\n            size="mini"\n            type="success"\n            @click="handleModifyStatus(row,\'published\')"\n          >\n            {{ $t(\'table.publish\') }}\n          </el-button>\n          <el-button\n            v-if="row.status!=\'draft\'"\n            size="mini"\n            @click="handleModifyStatus(row,\'draft\')"\n          >\n            {{ $t(\'table.draft\') }}\n          </el-button>\n          <el-button\n            v-if="row.status!=\'deleted\'"\n            size="mini"\n            type="danger"\n            @click="handleModifyStatus(row,\'deleted\')"\n          >\n            {{ $t(\'table.delete\') }}\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination\n      v-show="total>0"\n      :total="total"\n      :page.sync="listQuery.page"\n      :limit.sync="listQuery.limit"\n      @pagination="getList"\n    />\n\n    <el-dialog\n      :title="textMap[dialogStatus]"\n      :visible.sync="dialogFormVisible"\n    >\n      <el-form\n        ref="dataForm"\n        :rules="rules"\n        :model="temp"\n        label-position="left"\n        label-width="70px"\n        style="width: 400px; margin-left:50px;"\n      >\n        <el-form-item\n          :label="$t(\'table.type\')"\n          prop="type"\n        >\n          <el-select\n            v-model="temp.type"\n            class="filter-item"\n            placeholder="Please select"\n          >\n            <el-option\n              v-for="item in calendarTypeOptions"\n              :key="item.key"\n              :label="item.display_name"\n              :value="item.key"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item\n          :label="$t(\'table.date\')"\n          prop="timestamp"\n        >\n          <el-date-picker\n            v-model="temp.timestamp"\n            type="datetime"\n            placeholder="Please pick a date"\n          />\n        </el-form-item>\n        <el-form-item\n          :label="$t(\'table.title\')"\n          prop="title"\n        >\n          <el-input v-model="temp.title" />\n        </el-form-item>\n        <el-form-item :label="$t(\'table.status\')">\n          <el-select\n            v-model="temp.status"\n            class="filter-item"\n            placeholder="Please select"\n          >\n            <el-option\n              v-for="item in statusOptions"\n              :key="item"\n              :label="item"\n              :value="item"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item :label="$t(\'table.importance\')">\n          <el-rate\n            v-model="temp.importance"\n            :colors="[\'#99A9BF\', \'#F7BA2A\', \'#FF9900\']"\n            :max="3"\n            style="margin-top:8px;"\n          />\n        </el-form-item>\n        <el-form-item :label="$t(\'table.remark\')">\n          <el-input\n            v-model="temp.remark"\n            :autosize="{ minRows: 2, maxRows: 4}"\n            type="textarea"\n            placeholder="Please input"\n          />\n        </el-form-item>\n      </el-form>\n      <div\n        slot="footer"\n        class="dialog-footer"\n      >\n        <el-button @click="dialogFormVisible = false">\n          {{ $t(\'table.cancel\') }}\n        </el-button>\n        <el-button\n          type="primary"\n          @click="dialogStatus===\'create\'?createData():updateData()"\n        >\n          {{ $t(\'table.confirm\') }}\n        </el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog\n      :visible.sync="dialogPvVisible"\n      title="Reading statistics"\n    >\n      <el-table\n        :data="pvData"\n        border\n        fit\n        highlight-current-row\n        style="width: 100%"\n      >\n        <el-table-column\n          prop="key"\n          label="Channel"\n        />\n        <el-table-column\n          prop="pv"\n          label="Pv"\n        />\n      </el-table>\n      <span\n        slot="footer"\n        class="dialog-footer"\n      >\n        <el-button\n          type="primary"\n          @click="dialogPvVisible = false"\n        >{{ $t(\'table.confirm\') }}</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { fetchList, fetchPv, createArticle, updateArticle } from \'@/api/article\'\nimport waves from \'@/directive/waves\' // waves directive\nimport { parseTime } from \'@/utils\'\nimport Pagination from \'@/components/Pagination\' // secondary package based on el-pagination\n\nconst calendarTypeOptions = [\n  { key: \'CN\', display_name: \'China\' },\n  { key: \'US\', display_name: \'USA\' },\n  { key: \'JP\', display_name: \'Japan\' },\n  { key: \'EU\', display_name: \'Eurozone\' }\n]\n\n// arr to obj, such as { CN : "China", US : "USA" }\nconst calendarTypeKeyValue = calendarTypeOptions.reduce((acc, cur) => {\n  acc[cur.key] = cur.display_name\n  return acc\n}, {})\n\nexport default {\n  name: \'ComplexTable\',\n  components: { Pagination },\n  directives: { waves },\n  filters: {\n    statusFilter (status) {\n      const statusMap = {\n        published: \'success\',\n        draft: \'info\',\n        deleted: \'danger\'\n      }\n      return statusMap[status]\n    },\n    typeFilter (type) {\n      return calendarTypeKeyValue[type]\n    }\n  },\n  data () {\n    return {\n      tableKey: 0,\n      list: null,\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 20,\n        importance: undefined,\n        title: undefined,\n        type: undefined,\n        sort: \'+id\'\n      },\n      importanceOptions: [1, 2, 3],\n      calendarTypeOptions,\n      sortOptions: [{ label: \'ID Ascending\', key: \'+id\' }, { label: \'ID Descending\', key: \'-id\' }],\n      statusOptions: [\'published\', \'draft\', \'deleted\'],\n      showReviewer: false,\n      temp: {\n        id: undefined,\n        importance: 1,\n        remark: \'\',\n        timestamp: new Date(),\n        title: \'\',\n        type: \'\',\n        status: \'published\'\n      },\n      dialogFormVisible: false,\n      dialogStatus: \'\',\n      textMap: {\n        update: \'Edit\',\n        create: \'Create\'\n      },\n      dialogPvVisible: false,\n      pvData: [],\n      rules: {\n        type: [{ required: true, message: \'type is required\', trigger: \'change\' }],\n        timestamp: [{ type: \'date\', required: true, message: \'timestamp is required\', trigger: \'change\' }],\n        title: [{ required: true, message: \'title is required\', trigger: \'blur\' }]\n      },\n      downloadLoading: false\n    }\n  },\n  created () {\n    this.getList()\n  },\n  methods: {\n    getList () {\n      this.listLoading = true\n      fetchList(this.listQuery).then(response => {\n        this.list = response.data.items\n        this.total = response.data.total\n\n        // Just to simulate the time of the request\n        setTimeout(() => {\n          this.listLoading = false\n        }, 1.5 * 1000)\n      })\n    },\n    handleFilter () {\n      this.listQuery.page = 1\n      this.getList()\n    },\n    handleModifyStatus (row, status) {\n      this.$message({\n        message: \'操作成功\',\n        type: \'success\'\n      })\n      row.status = status\n    },\n    sortChange (data) {\n      const { prop, order } = data\n      if (prop === \'id\') {\n        this.sortByID(order)\n      }\n    },\n    sortByID (order) {\n      if (order === \'ascending\') {\n        this.listQuery.sort = \'+id\'\n      } else {\n        this.listQuery.sort = \'-id\'\n      }\n      this.handleFilter()\n    },\n    resetTemp () {\n      this.temp = {\n        id: undefined,\n        importance: 1,\n        remark: \'\',\n        timestamp: new Date(),\n        title: \'\',\n        status: \'published\',\n        type: \'\'\n      }\n    },\n    handleCreate () {\n      this.resetTemp()\n      this.dialogStatus = \'create\'\n      this.dialogFormVisible = true\n      this.$nextTick(() => {\n        this.$refs[\'dataForm\'].clearValidate()\n      })\n    },\n    createData () {\n      this.$refs[\'dataForm\'].validate((valid) => {\n        if (valid) {\n          this.temp.id = parseInt(Math.random() * 100) + 1024 // mock a id\n          this.temp.author = \'vue-element-admin\'\n          createArticle(this.temp).then(() => {\n            this.list.unshift(this.temp)\n            this.dialogFormVisible = false\n            this.$notify({\n              title: \'成功\',\n              message: \'创建成功\',\n              type: \'success\',\n              duration: 2000\n            })\n          })\n        }\n      })\n    },\n    handleUpdate (row) {\n      this.temp = Object.assign({}, row) // copy obj\n      this.temp.timestamp = new Date(this.temp.timestamp)\n      this.dialogStatus = \'update\'\n      this.dialogFormVisible = true\n      this.$nextTick(() => {\n        this.$refs[\'dataForm\'].clearValidate()\n      })\n    },\n    updateData () {\n      this.$refs[\'dataForm\'].validate((valid) => {\n        if (valid) {\n          const tempData = Object.assign({}, this.temp)\n          tempData.timestamp = +new Date(tempData.timestamp) // change Thu Nov 30 2017 16:41:05 GMT+0800 (CST) to 1512031311464\n          updateArticle(tempData).then(() => {\n            for (const v of this.list) {\n              if (v.id === this.temp.id) {\n                const index = this.list.indexOf(v)\n                this.list.splice(index, 1, this.temp)\n                break\n              }\n            }\n            this.dialogFormVisible = false\n            this.$notify({\n              title: \'成功\',\n              message: \'更新成功\',\n              type: \'success\',\n              duration: 2000\n            })\n          })\n        }\n      })\n    },\n    handleDelete (row) {\n      this.$notify({\n        title: \'成功\',\n        message: \'删除成功\',\n        type: \'success\',\n        duration: 2000\n      })\n      const index = this.list.indexOf(row)\n      this.list.splice(index, 1)\n    },\n    handleFetchPv (pv) {\n      fetchPv(pv).then(response => {\n        this.pvData = response.data.pvData\n        this.dialogPvVisible = true\n      })\n    },\n    handleDownload () {\n      this.downloadLoading = true\n      import(\'@/vendor/Export2Excel\').then(excel => {\n        const tHeader = [\'timestamp\', \'title\', \'type\', \'importance\', \'status\']\n        const filterVal = [\'timestamp\', \'title\', \'type\', \'importance\', \'status\']\n        const data = this.formatJson(filterVal, this.list)\n        excel.export_json_to_excel({\n          header: tHeader,\n          data,\n          filename: \'table-list\'\n        })\n        this.downloadLoading = false\n      })\n    },\n    formatJson (filterVal, jsonData) {\n      return jsonData.map(v => filterVal.map(j => {\n        if (j === \'timestamp\') {\n          return parseTime(v[j])\n        } else {\n          return v[j]\n        }\n      }))\n    }\n  }\n}\n<//script>\n\n      '}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(d["c"])(this.listQuery).then(function(t){e.list=t.data.items,e.total=t.data.total,setTimeout(function(){e.listLoading=!1},1500)})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleModifyStatus:function(e,t){this.$message({message:"操作成功",type:"success"}),e.status=t},sortChange:function(e){var t=e.prop,n=e.order;"id"===t&&this.sortByID(n)},sortByID:function(e){this.listQuery.sort="ascending"===e?"+id":"-id",this.handleFilter()},resetTemp:function(){this.temp={id:void 0,importance:1,remark:"",timestamp:new Date,title:"",status:"published",type:""}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs["dataForm"].clearValidate()})},createData:function(){var e=this;this.$refs["dataForm"].validate(function(t){t&&(e.temp.id=p()(100*Math.random())+1024,e.temp.author="vue-element-admin",Object(d["a"])(e.temp).then(function(){e.list.unshift(e.temp),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}))})},handleUpdate:function(e){var t=this;this.temp=r()({},e),this.temp.timestamp=new Date(this.temp.timestamp),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},updateData:function(){var e=this;this.$refs["dataForm"].validate(function(t){if(t){var n=r()({},e.temp);n.timestamp=+new Date(n.timestamp),Object(d["e"])(n).then(function(){var t=!0,n=!1,a=void 0;try{for(var l,i=s()(e.list);!(t=(l=i.next()).done);t=!0){var o=l.value;if(o.id===e.temp.id){var r=e.list.indexOf(o);e.list.splice(r,1,e.temp);break}}}catch(c){n=!0,a=c}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},handleDelete:function(e){this.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var t=this.list.indexOf(e);this.list.splice(t,1)},handleFetchPv:function(e){var t=this;Object(d["d"])(e).then(function(e){t.pvData=e.data.pvData,t.dialogPvVisible=!0})},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([n.e("chunk-6e83591c"),n.e("chunk-5164a781"),n.e("chunk-15221d3a"),n.e("chunk-87968d96")]).then(n.bind(null,"4bf8d")).then(function(t){var n=["timestamp","title","type","importance","status"],a=["timestamp","title","type","importance","status"],l=e.formatJson(a,e.list);t.export_json_to_excel({header:n,data:l,filename:"table-list"}),e.downloadLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?Object(u["d"])(t[e]):t[e]})})}}},g=y,w=n("2877"),k=Object(w["a"])(g,a,l,!1,null,null,null);t["default"]=k.exports}}]);